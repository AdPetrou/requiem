xEdit Scripts
=============

REQ_ArmorPatcher.pas
--------------------

Set armor rating, weight, and price of the selected armors.

The EditorID of the armors must adhere to the [EditorID Convention](../../wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records) and be listed in `REQ_ArmorPatcher.txt`. `REQ_ArmorPatcher.txt` maps identifiers of the form `<type>_<set>_<slot>` or `Artifact_<name>` to a triplet of armor rating, weight, and price. The identifier is extracted from the full EditorID which may include any mod prefix, the Ench, Var, or NP modifier, and any suffix. Values in the triplet should be exactly as displayed in xEdit's GUI, in particular floating-point values should have 6 significant digits. Additionally, identifiers may be specialized with a suffix, e.g. `Light_Imperial_Body_Studded`, in which case the values from the more specialized identifier are used.

`REQ_ArmorPatcher.txt` is generated by [armor_patcher.py](#armor_patcherpy) and should not be edited by hand.


REQ_NameAfterFullName.pas
-------------------------

Set the EditorID of the selected records based on their full names.

The user is asked to enter a prefix that will be prepended to all EditorIDs. Then, the name (subrecord 'FULL - Names') is processed by concatenating all words in upper camel case and removing apostrophes. For example, choosing the prefix "REQ\_Artifact" for the "Mace of Molag Bal" results in the EditorID `REQ_Artifact_MaceOfMolagBal`.

REQ_NameEnchantedWeapon.pas
---------------------------

Set the EditorID of the selected enchanted weapons based on the weapon and enchantment.

The EditorID of the template weapon and enchantment must adhere to the [EditorID Convention](../../wiki/EditorID-Convention). The script supports arbitrary mod prefixes on the template weapon and enchantment (not just "REQ"). However, the mod prefix of the enchanted weapon cannot be choosen but is defined by the template weapon.

At the end, the user is given the option to save a file containing all generated EditorIDs which can be used to provide an overview over all enchanted variants.

REQ_NameRecipe.pas
------------------

Set the EditorID of the selected constructible objects based on the workbench and created object.

The user is asked to enter a prefix that will be prepended to all EditorIDs. Then, the EditorID is constructed as required by the [EditorID Convention](../../wiki/EditorID-Convention#constructible-objects-cobj-records)

REQ_RecipePatcher.pas
---------------------

Set ingredients and conditions the selected constructible objects based on the workbench and created object.

The EditorID of the constructible objects must adhere to the [EditorID Convention](../../wiki/EditorID-Convention#constructible-objects-cobj-records) and be listed in both `REQ_RecipePatcherIngredients` and `REQ_RecipePatcherConditions`. `REQ_RecipePatcherIngredients` and `REQ_RecipePatcherConditions` maps identifiers of the form `<workbench>_<object>` to pairs of formid and count and sextuplets of comparison operator, comparison value, condition function, parameter 1, parameter 2, and function target respectively. The identifier is extracted from the full EditorID which may include any mod prefix and the Var modifier. Values in the pair and sextuplet should be exactly as displayed in xEdit's GUI with the expection of formids which must be of the form `<plugin-with-extension>:<local-formid>`, e.g. `Skyrim.esm:034CDD`.

`REQ_RecipePatcherIngredients` and `REQ_RecipePatcherConditions` is generated by [recipe_patcher.py](#recipe_patcherpy) and should not be edited by hand.

REQ_WeaponPatcher.pas
---------------------

Set damage, weight, price, speed, reach, and stagger of the selected melee weapon.

The EditorID of the armors must adhere to the [EditorID Convention](../../wiki/EditorID-Convention#weapon-weap-records) and be listed in `REQ_WeaponPatcher.txt`. `REQ_WeaponPatcher.txt` maps identifiers of the form `Weapon_<set>_<type>` or `Artifact_<name>` to a sextuplet of damage, weight, price, speed, reach, and stagger. The identifier is extracted from the full EditorID which may include any mod prefix, the Ench, Var, or NP modifier, and any suffix. Values in the sextuplet should be exactly as displayed in xEdit's GUI, in particular floating-point values should have 6 significant digits.

`REQ_WeaponPatcher.txt` is generated by [armor_patcher.py](#weapon_patcherpy) and should not be edited by hand.

Python Scripts
==============

Some scripts may require running `pip install pandas openpyxl` in a terminal first.

armor_patcher.py
----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](../Spreadsheet/Armor.xlsx).

link_scripts.py
---------------

Creates a hard link for every file in this directory starting with "REQ_" to xEdit so that the files are simultaneously under version control in this git repository and available to xEdit.

If xEdit is installed in a location other than `C:\Skyrim Tools\SSEEdit`, the script should be invoked by dragging the folder containing `SSEEdit.exe` onto it.

recipe_patcher.py
-----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](../Spreadsheet/Armor.xlsx) and [Weapon.xlsx](../Spreadsheet/Weapon.xlsx).

strict_dict.py
--------------

Implements a dictionary that raises an exception when assigning a value to an existing key.

weapon_patcher.py
-----------------

Generates `REQ_WeaponPatcher.txt` based on the data in [Weapon.xlsx](../Spreadsheet/Weapon.xlsx).
