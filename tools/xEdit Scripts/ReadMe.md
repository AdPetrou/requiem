Installation
============

It just works
-------------

Copy all files in this folder to the folder `Edit Scripts` of your xEdit installation.

Advanced
--------

See [link_scripts.py](#link_scriptspy).


xEdit Scripts
=============

REQ_AddItemsToLeveledList.pas
-----------------------------

Create a new leveled item and add the selected items to it.

The script prompts the user to enter the EditorID of the new leveled item. The leveled item is created in the file of the first selected item.


REQ_AddItemsToOutfit.pas
-----------------------------

Create a new outfit and add the selected items to it.

The script prompts the user to enter the EditorID of the new outfit. The outfit is created in the file of the first selected item.


REQ_ArmorPatcher.pas
--------------------

Set armor rating, weight, and price of the selected armors based on `REQ_ArmorPatcher.txt`.

`REQ_ArmorPatcher.txt` maps armor identifiers of the form `<type>_<set>_<slot>` or `Artifact_<name>` to a triplet of armor rating, weight, and price. Armors are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records). The identifier is automatically extracted from an armor's full EditorID which may include any mod prefix (not just "REQ"), the "Ench", "Var", or "NP" modifier, and any suffix. Values in the triplet should be exactly as displayed in xEdit's GUI. Additionally, identifiers may be specialized with a suffix, e.g. `Light_Imperial_Body_Studded`, in which case the values from the more specialized identifier are used.

`REQ_ArmorPatcher.txt` is generated by [armor_patcher.py](#armor_patcherpy) and should not be edited by hand.


REQ_Name1stPersonWeapon.pas
---------------------------

Set the EditorID of the selected 1st person weapon models based on the referencing weapon.

The referencing weapon must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#weapon-weap-records).



REQ_NameAfterFullName.pas
-------------------------

Set the EditorID of the selected records based on their full names.

The script prompts the user to enter a prefix that will be prepended to all EditorIDs. Then, the name (subrecord 'FULL - Names') is processed by concatenating all words in upper camel case and removing apostrophes. For example, choosing the prefix "REQ\_Artifact\_" for "Gadnor's Staff of Charming" results in the EditorID `REQ_Artifact_GadnorsStaffOfCharming`.


REQ_NameArmor.pas
-------------------------

Set the EditorID of the selected armors based on their type, material/set, and equip slot.

The script prompts the user to enter the name of the armor set. Then, the EditorID is assembled so that it adheres to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#armor-clothing-and-jewelry-armo-records).


REQ_NameEnchantedWeapon.pas
---------------------------

Set the EditorID of the selected enchanted weapons based on the weapon and enchantment.

The EditorID of the template weapon and enchantment must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention). The template weapon and enchantment may have an arbitrary mod prefix (not just "REQ"), but the mod prefix of the enchanted weapon cannot be chosen and is defined by the template weapon.

At the end, the user is given the option to save all generated EditorIDs in a file, which can be used to provide an overview over all enchanted variants.


REQ_NameRecipe.pas
------------------

Set the EditorID of the selected constructible objects based on the workbench and item.

The script prompts the user to enter a prefix that will be prepended to all EditorIDs. Then, the EditorID is constructed as required by the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#constructible-objects-cobj-records). The EditorID of the item is taken ad verbatim and therefore it is a soft requirement that all items already have a proper EditorID.


REQ_RecipePatcher.pas
---------------------

Set ingredients and conditions of the selected recipes based on `REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt`.

`REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt` map recipe identifiers of the form `<workbench>_<item>` to pairs of formid and count and to sextuplets of comparison operator, comparison value, condition function, parameter 1, parameter 2, and function target. Recipes are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#constructible-objects-cobj-records). The identifier is automatically extracted from a recipe's full EditorID which may include any mod prefix (not just "REQ") and the Var modifier. Values in the pair and sextuplet should be exactly as displayed in xEdit's GUI with the exception of formids which must be of the form `Skyrim.esm:034CDD`.

`REQ_RecipePatcherIngredients.txt` and `REQ_RecipePatcherConditions.txt` are generated by [recipe_patcher.py](#recipe_patcherpy) and should not be edited by hand.


REQ_WeaponPatcher.pas
---------------------

Set damage, weight, price, speed, reach, and stagger of the selected melee weapon based on `REQ_WeaponPatcher.txt`.

`REQ_WeaponPatcher.txt` maps weapon identifiers of the form `Weapon_<set>_<type>` or `Artifact_<name>` to a sextuplet of damage, weight, price, speed, reach, and stagger. Weapons are identified by EditorID and must adhere to the [EditorID Convention](https://github.com/ProbablyManuel/requiem/wiki/EditorID-Convention#weapon-weap-records). The identifier is automatically extracted from an weapon's full EditorID which may include any mod prefix (not just "REQ"), the "Ench", "Var", or "NP" modifier, and any suffix. Values in the sextuplet should be exactly as displayed in xEdit's GUI.

`REQ_WeaponPatcher.txt` is generated by [weapon_patcher.py](#weapon_patcherpy) and should not be edited by hand.




Python Scripts
==============

The scripts reading from Excel files may require running `pip install pandas openpyxl` first.


armor_patcher.py
----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](patcher_data#armor).

The script can be invoked by dragging a custom text file onto it to provide easy integration of third-party armors. The file must contain lines of the form "Heavy_Runic,Heavy_Steel" where the first value is a new armor set and the second value is an existing armor set. This ensures armors with EditorID `<prefix>_Heavy_Runic_<part>` will be treated as steel armor. Due to a library limitation the file must contain at least two lines.


link_scripts.py
---------------

Creates a hard link for every file in this directory starting with "REQ_" to xEdit so that the files are simultaneously under version control in this git repository and available to xEdit.

If xEdit is installed in a location other than `C:\Skyrim Tools\SSEEdit`, the script should be invoked by dragging the folder containing `SSEEdit.exe` onto it.


recipe_patcher.py
-----------------

Generates `REQ_ArmorPatcher.txt` based on the data in [Armor.xlsx](patcher_data#armor) and [Weapon.xlsx](patcher_data#weapon).

The script can be invoked by dragging two custom text files onto it to provide easy integration of third-party armors and weapons. The files should be equal to the ones used to extend the armor and weapon patcher.


strict_dict.py
--------------

Implements a dictionary that raises an exception when assigning a value to an existing key.


weapon_patcher.py
-----------------

Generates `REQ_WeaponPatcher.txt` based on the data in [Weapon.xlsx](patcher_data#weapon).

The script can be invoked by dragging a custom text file onto it to provide easy integration of third-party weapons. The file must contain lines of the form "Weapon_Runic,Weapon_Steel" where the first value is a new weapon set and the second value is an existing weapon set. This ensures weapons with EditorID `<prefix>_Weapon_Runic_<type>` will be treated as steel weapons. Due to a library limitation the file must contain at least two lines.
